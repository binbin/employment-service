import React, { useState } from "react";
import Navbar from "../components/Navbar";
import SearchBox from "../components/SearchBox";
import "./Policy.css";
import Timeline from "../components/Timeline";

// 结构化的政策数据
const policyData = [
  {
    序号: 1,
    政策名称: "就业登记",
    主要对象: "自主创业者、灵活就业者、新入职人员",
    核心内容: "就业30日内登记，需身份证等材料",
    办理流程: "线上线下申请→核验录入平台（线上3日、线下即时）",
    主管机构: "社区/乡镇或旗县就业服务中心",
  },
  {
    序号: 2,
    政策名称: "失业登记",
    主要对象: "16–退休年龄、无业者",
    核心内容: "满足条件可登记失业",
    办理流程: "线上线下申请→核验录入平台（线上3日、线下即时）",
    主管机构: "社区/乡镇或旗县就业服务中心",
  },
  {
    序号: 3,
    政策名称: "就业创业证申领",
    主要对象: "已办就业/失业登记者",
    核心内容: "发证证明身份",
    办理流程: "社区办理→系统发证（线上3日、线下即时）",
    主管机构: "社区/乡镇就业服务平台",
  },
  {
    序号: 4,
    政策名称: "就业创业证核验",
    主要对象: "已持证者",
    核心内容: "跨省证件查询/核实",
    办理流程: "平台查询核验（即时）",
    主管机构: "社区/乡镇就业服务机构",
  },
  {
    序号: 5,
    政策名称: "就业困难人员认定",
    主要对象: "城镇困难求职者6类",
    核心内容: "含大龄、残疾、零就业家庭等",
    办理流程: "社区→乡镇→旗区三级审核",
    时限: "约19工作日",
    主管机构: "各级公共就业服务机构",
  },
  {
    序号: 6,
    政策名称: "零就业家庭认定",
    主要对象: "无收入家庭",
    核心内容: "同上",
    办理流程: "三级审核流程",
    时限: "≈10工作日",
    主管机构: "同上",
  },
  {
    序号: 7,
    政策名称: "公益性岗位补贴",
    主要对象: "困难者、脱贫人口",
    核心内容: "岗位补贴、最长3年",
    办理流程: "单位申报 → 审核 → 公示 → 发放",
    时限: "审核7+5+5+10+5日",
    主管机构: "旗县区就业服务中心",
  },
  {
    序号: 8,
    政策名称: "困难人员社保补贴",
    主要对象: "灵活就业者或用人单位",
    核心内容: "缴费补贴至退休",
    办理流程: "材料→多级审核→财政拨付",
    时限: "≈39工作日",
    主管机构: "社区—乡镇—旗区—财政",
  },
  {
    序号: 9,
    政策名称: "毕业生社保补贴",
    主要对象: "离校≤2年毕业生",
    核心内容: "灵活就业/企业吸纳补贴",
    办理流程: "同8，分个体和企业流程",
    时限: "同8",
    主管机构: "同上",
  },
  {
    序号: 10,
    政策名称: "就业创业服务补助",
    主要对象: "就业机构",
    核心内容: "脱贫就业服务每年5万元",
    办理流程: "机构申报 → 旗县审核",
    时限: "旗县5日",
    主管机构: "旗县就业服务中心",
  },
  {
    序号: 11,
    政策名称: "扶贫基地奖补",
    主要对象: "吸纳脱贫人口基地",
    核心内容: "6个月合同，按人数测算",
    办理流程: "提交申请 → 审核 → 财政拨付",
    时限: "旗县5日",
    主管机构: "旗县就业服务中心",
  },
  {
    序号: 12,
    政策名称: "毕业生储备补贴",
    主要对象: "中小企业吸纳毕业生",
    核心内容: "每人每月≥1000元生活补贴",
    办理流程: "单位申报 → 审核拨付",
    时限: "初审15日",
    主管机构: "旗县就业服务中心",
  },
  {
    序号: 13,
    政策名称: "就业见习补贴",
    主要对象: "失业青年、毕业生",
    核心内容: "单位70%工资补贴，留用达标升至100%",
    办理流程: "见习单位申报 → 审核拨付",
    时限: "旗县10日",
    主管机构: "旗县就业服务中心",
  },
  {
    序号: 14,
    政策名称: "创业培训补贴",
    主要对象: "多类创业群体",
    核心内容: "培训合格后补贴",
    办理流程: "劳务中心报送 → 审核拨付",
    时限: "8日",
    主管机构: "市/旗县就业服务中心",
  },
  {
    序号: 15,
    政策名称: "一次性创业补贴",
    主要对象: "首次创业者（毕业生、困难者等）",
    核心内容: "正常经营>1年后发补贴",
    办理流程: "申请→旗县初审→人社复审",
    时限: "8日初审",
    主管机构: "旗县就业服务中心",
  },
  {
    序号: 16,
    政策名称: "创业服务补贴",
    主要对象: "创业服务机构",
    核心内容: "每实体2000元",
    办理流程: "单位申报→旗县初审→人社复审",
    时限: "8日",
    主管机构: "旗县就业服务中心",
  },
  {
    序号: 17,
    政策名称: "项目库补贴",
    主要对象: "项目征集单位",
    核心内容: "建库费用补贴",
    办理流程: "同16流程",
    时限: "8日",
    主管机构: "同上",
  },
  {
    序号: 18,
    政策名称: "个人创业贷款",
    主要对象: "多类优先群体",
    核心内容: "≤30万元贷款＋政府贴息",
    办理流程: "材料递交 → 就业部门审核 → 银行发放",
    时限: "7日审核",
    主管机构: "就业服务中心 & 经办银行",
  },
  {
    序号: 19,
    政策名称: "小微企业贷款",
    主要对象: "小微企业",
    核心内容: "≤400万元贷款＋贴息",
    办理流程: "材料递交 → 部门审核 → 银行发放",
    时限: "7日",
    主管机构: "就业服务中心 & 经办银行",
  },
  {
    序号: 20,
    政策名称: "降低失业保险费率",
    主要对象: "所有城镇参保单位/职工",
    核心内容: "缓减费率至双0.5%",
    办理流程: "自动执行",
    时限: "即时",
    主管机构: "社保机构",
  },
  {
    序号: 26,
    政策名称: "稳岗返还",
    主要对象: "合规参保企业等",
    核心内容: "按比例返还失保费",
    办理流程: "系统比对，无需申请",
    时限: "即享或22工作日审核",
    主管机构: "社保机构",
  },
  {
    序号: 22,
    政策名称: "扩岗补助",
    主要对象: "招聘特定人群的企业",
    核心内容: "每招一人1500元",
    办理流程: "系统推送或企业申请",
    时限: "数据刷新后5日审批",
    主管机构: "社保机构",
  },
  {
    序号: 23,
    政策名称: "技能提升补贴",
    主要对象: "失保参保人员",
    核心内容: "拿证后按级别补贴",
    办理流程: "自助申请 → 审核发放",
    时限: "10日",
    主管机构: "社保机构",
  },
  {
    序号: 24,
    政策名称: "失业保险金",
    主要对象: "参保后失业人员",
    核心内容: "符合条件可领取",
    办理流程: "申请→审核→发放",
    时限: "10日",
    主管机构: "社保机构",
  },
];

export default function Policy() {
  const [filteredData, setFilteredData] = useState(policyData);

  const handleSearch = (searchTerm) => {
    if (!searchTerm.trim()) {
      setFilteredData(policyData);
      return;
    }

    const filtered = policyData.filter(
      (policy) =>
        policy.政策名称.toLowerCase().includes(searchTerm.toLowerCase()) ||
        policy.核心内容.toLowerCase().includes(searchTerm.toLowerCase()) ||
        policy.主要对象.toLowerCase().includes(searchTerm.toLowerCase()) ||
        policy.主管机构.toLowerCase().includes(searchTerm.toLowerCase())
    );
    setFilteredData(filtered);
  };

  return (
    <>
      <Navbar />
      <div className="policy-container">
        <SearchBox placeholder="搜索就业政策..." onSearch={handleSearch} />
        <h2>就业创业好政策</h2>
        <div className="policy-list-wrapper">
          {filteredData.length > 0 ? (
            filteredData.map((policy, i) => (
              <div className="policy-card" key={i}>
                <div className="policy-title">{policy.政策名称}</div>
                <div className="policy-content">{policy.核心内容}</div>
                <div className="policy-meta">
                  <span>主要对象：{policy.主要对象}</span>
                  <span>主管机构：{policy.主管机构}</span>
                </div>
                <div className="policy-details">
                  <div className="policy-flow-section">
                    <h4>办理流程：</h4>
                    <Timeline steps={policy.办理流程} />
                  </div>
                  {policy.时限 && (
                    <div className="policy-time">时限：{policy.时限}</div>
                  )}
                </div>
              </div>
            ))
          ) : (
            <div className="no-results">
              <p>没有找到相关政策，请尝试其他关键词</p>
            </div>
          )}
        </div>
      </div>
    </>
  );
}
